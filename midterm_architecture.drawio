<mxfile host="app.diagrams.net" modified="2025-12-14T00:00:00.000Z" agent="GPT" version="24.7.5">
  <diagram id="midterm-arch" name="Midterm Architecture">
    <mxGraphModel dx="1100" dy="850" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="850" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- DATA + INDEX BUILD -->
        <mxCell id="10" value="data/claim_timeline.md&#10;(single claim file)" style="shape=document;whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="60" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="11" value="Loader&#10;SimpleDirectoryReader" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="60" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="12" value="HierarchicalNodeParser&#10;chunk_sizes: 1024 / 512 / 128" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="60" width="260" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="13" value="SummaryIndex&#10;(tree_summarize)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="35" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="14" value="VectorStoreIndex&#10;(leaf embeddings: 128)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="125" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="15" value="Node graph (parent/child)&#10;1024 ⇄ 512 ⇄ 128" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="215" width="210" height="70" as="geometry"/>
        </mxCell>

        <!-- RUNTIME: MAIN + AGENTS -->
        <mxCell id="20" value="User (CLI)&#10;python src/main.py" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="420" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="21" value="ManagerAgent&#10;(routes query)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="420" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="22" value="SummarizationAgent&#10;summary_engine" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="380" width="240" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="23" value="NeedleAgent&#10;needle_engine" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="480" width="240" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="24" value="AutoMergingRetriever&#10;(merge leaf hits → parent nodes)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="485" width="210" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="25" value="Answer&#10;(to user)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="400" width="210" height="70" as="geometry"/>
        </mxCell>

        <!-- MCP LANE -->
        <mxCell id="30" value="Tool wrapper&#10;compute_days_between_dates()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="590" width="240" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="31" value="MCP Client&#10;(ClientSession + stdio_client)&#10;call_tool(&quot;days_between_dates&quot;)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="590" width="210" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="32" value="MCP Server (STDIO)&#10;src/mcp/date_server.py&#10;Tool: days_between_dates" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1080" y="590" width="230" height="90" as="geometry"/>
        </mxCell>

        <!-- EVALUATION LANE -->
        <mxCell id="40" value="eval/judge.py&#10;+ test_cases.json" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="720" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="41" value="System under test&#10;(indexes + agents)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="720" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="42" value="Judge LLM&#10;(scores: correctness / relevance / recall)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="720" width="280" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="43" value="Evaluation report&#10;(avg scores + per-test)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="720" width="210" height="70" as="geometry"/>
        </mxCell>

        <!-- EDGES -->
        <mxCell id="e1" style="endArrow=block;html=1;" edge="1" parent="1" source="10" target="11">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e2" style="endArrow=block;html=1;" edge="1" parent="1" source="11" target="12">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e3" style="endArrow=block;html=1;" edge="1" parent="1" source="12" target="13">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e4" style="endArrow=block;html=1;" edge="1" parent="1" source="12" target="14">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e5" style="endArrow=block;html=1;" edge="1" parent="1" source="12" target="15">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e6" style="endArrow=block;html=1;" edge="1" parent="1" source="20" target="21">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e7" value="overview / timeline" style="endArrow=block;html=1;" edge="1" parent="1" source="21" target="22">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e8" value="needle / specific / tool" style="endArrow=block;html=1;" edge="1" parent="1" source="21" target="23">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e9" style="endArrow=block;html=1;" edge="1" parent="1" source="22" target="13">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e10" style="endArrow=block;html=1;" edge="1" parent="1" source="13" target="25">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e11" style="endArrow=block;html=1;" edge="1" parent="1" source="23" target="24">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e12" style="endArrow=block;html=1;" edge="1" parent="1" source="24" target="25">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e13" value="retrieves leaf hits" style="endArrow=block;html=1;" edge="1" parent="1" source="24" target="14">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e14" value="merges using parents" style="endArrow=block;html=1;" edge="1" parent="1" source="24" target="15">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e15" value="date-diff question" style="endArrow=block;html=1;" edge="1" parent="1" source="23" target="30">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e16" style="endArrow=block;html=1;" edge="1" parent="1" source="30" target="31">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e17" style="endArrow=block;html=1;" edge="1" parent="1" source="31" target="32">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e18" value="tool result (days)" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="32" target="31">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e19" value="days" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="31" target="30">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e20" value="uses tool output" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="30" target="23">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e21" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="40" target="41">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e22" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="41" target="42">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e23" style="endArrow=block;html=1;dashed=1;" edge="1" parent="1" source="42" target="43">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
